###########################################
#FOR CONFIGURATION OF IPSETS for FIREWALLD#
###########################################

# For use in configuration files "02_conf_zone_sources" and "04_conf_zone_rich_rules_special" as well as within the parameter
    # "zone_rich_rules_general" (config files "01_conf_custom_firewall_zones_templates" and "01_conf_standard_firewall_zones_templates").
# It is possible to create several ipset conf (#ipset_name) with the same name but within different template_names to apply to different hosts.
# Ipset conf template names must be unique.
# Configuration templates where a specific list of inventory hosts (separated by ",") is specified within
    # the "inv_host_list_for_apply" parameter take precedence (over "inv_host_list_for_apply=all").
# The ipset template name must always contain a substring "--TMPLT" at the end.
# Ipset conf template name examples: ipset1--TMPLT, ipset--ver1--TMPLT, ipset--special_ver2--TMPLT.
# About version of ipset = ipset v7.1, protocol version: 7

###EXAMPLE (with explanation)
#[some_ipset_template_name--TMPLT:BEGIN]
#ipset_name=some_ipset_name
    # All ipsets not configured within this config will be removed on remote hosts.
    # Create ipset-list = "firewall-cmd --permanent --new-ipset=some_ipset_name --type=some_ipset_type" (for information).

#ipset_type=some_ipset_type
    # Possible values:
	# Therefore only a limited list of ipset types can be used as sources in zones: hash:ip; hash:ip,port; hash:ip,mark; hash:net; hash:net,port; hash:net,iface; hash:mac.
	###
	# hash:ip = a selective list of IP addresses (or IP subnets with the same mask).
	    # Can be used as source in zones.
	    # Examples: 192.168.10.67; 192.168.11.0/24.
	
	# hash:ip,port = a selective list of IP addresses, where a port can be stored with each address. You can also store a transport layer protocol ID for each port number.
	    # Can be used as source in zones.
	    # Examples: 192.168.12.12,udp:53; 192.168.1.0/24,80-82; 192.168.1.1,vrrp:0; 192.168.1.1,80.

	# hash:ip,mark = uses a hash to store IP address and packet mark pairs. Allows you to set bits you are interested in the packet mark.
	    # This values is then used to perform bitwise AND operation for every mark added. Markmask can be any value between 1 and 4294967295, by default all 32 bits are set.
	    # The mark can be any value between 0 and 4294967295.
	    # Can be used as source in zones.
	    # Examples: 192.168.1.0/24,555; 192.168.1.1,0x63; 192.168.1.1,111236.

	# hash:net = selective list of IP subnets (blocks of IP addresses). Unlike "hash:ip", subnets with different masks can be present in one list.
	    # Can be used as source in zones.
	    # Examples: 192.168.0.0/24; 10.1.0.0/16; 192.168.0/24; 192.168.0/30 nomatch (nomatch = exception).

	# hash:net,port = uses a hash to store different sized IP network address and port pairs.
	    # The port number is interpreted together with a protocol (default TCP) and zero protocol number cannot be used.
	    # Network address with zero prefix size is not accepted either.
	    # You can also store a transport layer protocol ID for each port number.
	    # Can be used as source in zones.
	    # Examples: 192.168.0/24,25; 10.1.0.0/16,80; 192.168.0/24,25; 192.168.1.0/24,tcp:8081.

	# hash:net,iface = a selective list of IP subnets, whereby the name of the network interface can be stored with each subnet.
	    # There is a limitation that you cannot store more than 64 interface names with the same subnet address.
	    # This data type is useful when a system has a large number of network interfaces (for example, hundreds of VLAN interfaces).
	    # Can be used as source in zones.
	    # Examples: 192.168.0/24,eth0; 10.1.0.0/16,eth1; 192.168.0/24,eth0.

	# hash:mac = uses a hash to store MAC addresses. Zero valued MAC addresses cannot be stored in a "hash:mac" type of set. For matches on destination MAC addresses.
	    # Can be used as source in zones.
	    # Examples: 01:02:03:04:05:06.
	#############################################
	# hash:ip,port,ip = a selective list of IP addresses, where a port and one more IP address can be stored with each address.
	    # You can also store a transport layer protocol ID for each port number.
	    # Examples: 192.168.1.1,80,10.0.0.1; 192.168.1.1,udp:53,10.0.0.1.
	
	# hash:ip,port,net = a selective list of IP addresses, where a port and an IP subnet can be stored with each address.
	    # You can also store a transport layer protocol ID for each port number.
	    # Examples: 192.168.1,tcp:8080,10.0.0/24; 192.168.2,25,10.1.0.0/16; 192.168.1,80.10.0.0/24.
	
	# hash:net,net = uses a hash to store pairs of different sized IP network addresses.
	    # Bear in mind that the first parameter has precedence over the second, so a nomatch entry could be potentially be ineffective if a more specific first parameter 
	    # existed with a suitable second parameter. Network address with zero prefix size cannot be stored in this type of set.
	    # Examples: 192.168.0.0/24,10.0.1.0/24; 10.1.0.0/16,10.255.0.0/24; 192.168.0/24,192.168.54.0-192.168.54.255; 192.168.0/30,192.168.64/30 nomatch.
	
	# hash:net,port,net = behaves similarly to hash:ip,port,net but accepts a cidr value for both the first and last parameter.
	    # Either subnet is permitted to be a /0 should you wish to match port between all destinations.
	    # You can also store a transport layer protocol ID for each port number.
	    # Examples: 192.168.1.0/24,0,10.0.0/24; 192.168.2.0/24,25,10.1.0.0/16; 192.168.1.1,80,10.0.0.1; 192.168.1.2,tcp:8081,10.0.0.2.
	
    # Get ipset-types = "firewall-cmd --get-ipset-types" (for information only).

#inv_host_list_for_apply=all/list of inventory hosts separated by ",".
    # If "all" -> the configuration will be applied to all inventory hosts.

#ipset_list_dir (for information only).
    # The ipset list files (and subfolders) will be created in the "playbooks/dyn_fwrules_playbooks/ipsets/some_ipset_template_name/inventory_host/some_ipset_name" directory.
    # after run "IPSET_files_operation.pl".
    # For example, "playbooks/dyn_fwrules_playbooks/ipsets/some_ipset_template_name/inventory_host/some_ipset_name/some_ipset_name-NUM.txt".
    # See file "playbooks/dyn_fwrules_playbooks/ipsets/info" for more details.
    ###
    # The input values for the "ipset_list" parameter must match the selected "ipset_type".
    # Add ipset list from file = "firewall-cmd --permanent --ipset=some_ipset_name --add-entries-from-file=some_ipset_list.txt" (for information only).
    # Remove ipset list from file = "firewall-cmd --permanent --ipset=some_ipset_name --remove-entries-from-file=some_ipset_list.txt" (for information only).
#[some_ipset_template_name--TMPLT:END]
