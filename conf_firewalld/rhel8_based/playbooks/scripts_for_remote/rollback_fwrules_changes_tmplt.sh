#!/usr/bin/bash

###GENERATED BY ansible_helpers/conf_firewalld (https://github.com/vladimir-chursin000/ansible_helpers)

SELF_DIR="$(dirname $(readlink -f $0))";

###ARGV
TIMEOUT_num=!_TIMEOUT_NUM_!;
###ARGV

###STATIC_VARS
FWRULES_BACKUP_DIR="$SELF_DIR/fwrules_backup_now";
FWRULES_DIR='/etc/firewalld';
###STATIC_VARS

###VARS
ARR_EL0='';
declare -a FWRULES_BACKUP_ARR_list;
declare -a FWRULES_ARR_list;
EXE_RES='';
###VARS

while :
do
    sleep 60;

    let "TIMEOUT_num-=1";
    if [[ "$TIMEOUT_num" -le "0" ]]; then
	###DO ROLLBACK of firewall rules changes
	if [ -d "$HOME/ansible_helpers/conf_firewalld/fwrules_backup_now" ]; then
	    rm -rf /etc/firewalld/*;
	    cp -r ~/ansible_helpers/conf_firewalld/fwrules_backup_now/* /etc/firewalld;
	    firewall-cmd --reload;
	fi;
	###DO ROLLBACK of firewall rules changes
	
	exit;
    fi;
done;
